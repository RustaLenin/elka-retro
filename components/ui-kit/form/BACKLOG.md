# UI Form Kit - Backlog

Этот файл содержит планы и предложения по улучшению UI Form Kit в контексте текущей архитектуры (State Sharing by Reference).

---

## Предложения по улучшению

### Функциональность

#### 1. Навигация по шагам в wizard формах
**Статус:** Предложение  
**Приоритет:** Средний  
**Описание:**
- Добавить публичные методы `nextStep()`, `prevStep()`, `goToStep(stepNumber)` в `ui-form-controller`
- Валидация на уровне шагов (блокировка перехода к следующему шагу при ошибках)
- Автоматическая валидация текущего шага перед переходом

**Текущая реализация:**
- Layout scaffolding для steps уже реализован
- Шаги рендерятся из конфигурации
- Нужно добавить логику навигации и валидации

**Потенциальные проблемы:**
- Нужно определить, какие поля относятся к какому шагу
- Валидация должна работать с текущей архитектурой state-sharing-by-reference

---

#### 2. Условные поля (показывать/скрывать)
**Статус:** Предложение  
**Приоритет:** Средний  
**Описание:**
- Поля могут показываться/скрываться в зависимости от значений других полей
- Поддержка условий через конфигурацию: `{ showWhen: { fieldId: 'value' } }`
- Автоматическое обновление видимости при изменении зависимых полей

**Текущая реализация:**
- Поля рендерятся из конфигурации в `form-controller-template-utils.js`
- Нужно добавить логику условного рендеринга и отслеживания изменений

**Потенциальные проблемы:**
- Условные поля должны работать с валидацией (скрытые поля не должны валидироваться)
- Нужно учесть влияние на `state.values` (очищать значения скрытых полей?)

---

#### 3. Cross-field валидация
**Статус:** Предложение  
**Приоритет:** Низкий  
**Описание:**
- Валидация, зависящая от значений других полей
- Пример: "Пароль и подтверждение пароля должны совпадать"
- Поддержка в `validation-registry.js` через контекст формы

**Текущая реализация:**
- `validation-registry.js` уже поддерживает async валидаторы
- Нужно расширить API для передачи контекста формы в валидаторы

**Потенциальные проблемы:**
- Валидаторы должны иметь доступ к `form.getValues()` или `form.state.values`
- Нужно обеспечить реактивность (валидация при изменении зависимых полей)

---

#### 4. Улучшение autosubmit
**Статус:** Предложение  
**Приоритет:** Низкий  
**Описание:**
- Поддержка разных debounce для разных типов полей
- Индикация ожидания автопередачи (loading state)
- Возможность отмены автопередачи при множественных быстрых изменениях

**Текущая реализация:**
- Базовая поддержка autosubmit есть в `form-controller.js`
- Нужно расширить конфигурацию и добавить визуальную индикацию

---

#### 5. Lazy loading для select компонентов
**Статус:** Предложение  
**Приоритет:** Низкий  
**Описание:**
- Виртуализация для больших списков опций (1000+ элементов)
- Динамическая загрузка опций при прокрутке
- Поддержка поиска с серверной фильтрацией

**Текущая реализация:**
- `ui-select-single` и `ui-select-multi` уже поддерживают поиск
- Нужно добавить виртуализацию и lazy loading

---

#### 6. Иерархические списки в select
**Статус:** Предложение  
**Приоритет:** Низкий  
**Описание:**
- Поддержка групп категорий в select компонентах
- Визуальное отображение иерархии (отступы, группировка)
- Навигация по группам

**Текущая реализация:**
- `field-config-adapter.js` работает с плоской структурой таксономий
- Нужно расширить поддержку иерархических структур

---

### Accessibility

#### 7. Улучшение ARIA-атрибутов
**Статус:** Предложение  
**Приоритет:** Средний  
**Описание:**
- Улучшение ARIA-атрибутов для screen readers
- Поддержка `aria-describedby` для связи полей с описаниями и ошибками
- Правильная маркировка обязательных полей

**Текущая реализация:**
- Базовая поддержка ARIA есть
- Нужно расширить для всех компонентов

---

#### 8. Фокус-менеджмент
**Статус:** Предложение  
**Приоритет:** Средний  
**Описание:**
- Управление фокусом при открытии модальных форм
- Фокус на первое поле при открытии формы
- Фокус на кнопку submit после успешной отправки
- Ловушка фокуса в модальных окнах

**Текущая реализация:**
- Модальная интеграция реализована через `mode="modal"`
- Нужно добавить логику управления фокусом

---

#### 9. Навигация с клавиатуры
**Статус:** Предложение  
**Приоритет:** Средний  
**Описание:**
- Полноценная навигация по полям с клавиатуры (Tab, Shift+Tab)
- Навигация по шагам wizard с клавиатуры (стрелки, Enter)
- Горячие клавиши для действий (Ctrl+Enter для submit)

---

### Производительность

#### 10. Оптимизация рендеринга
**Статус:** Предложение  
**Приоритет:** Низкий  
**Описание:**
- Дебаунс для частых обновлений состояния (особенно для autosubmit)
- Мемоизация вычислений (derive state)
- Ленивая загрузка компонентов (code splitting)

**Текущая реализация:**
- Компоненты рендерятся напрямую из конфигурации
- Нужно оптимизировать для больших форм (50+ полей)

---

#### 11. Виртуализация больших списков
**Статус:** Предложение  
**Приоритет:** Низкий  
**Описание:**
- Виртуализация для select с большим количеством опций
- Рендеринг только видимых элементов
- Плавная прокрутка и загрузка

---

### Документация

#### 12. Примеры использования
**Статус:** Предложение  
**Приоритет:** Средний  
**Описание:**
- Создать папку `examples/` с реальными примерами форм
- Интерактивная документация (Storybook или аналог)
- Миграционные гайды при изменении API

---

#### 13. Локализация сообщений
**Статус:** Предложение  
**Приоритет:** Низкий  
**Описание:**
- Локализация сообщений об ошибках
- Поддержка разных языков через конфигурацию
- Кастомизация текстов валидации

---

### Тестирование

#### 14. Unit тесты
**Статус:** Предложение  
**Приоритет:** Средний  
**Описание:**
- Тесты для валидаторов (`validation-registry.js`)
- Тесты для компонентов (Web Components testing)
- Тесты для утилит (helpers)
- Интеграционные тесты для форм

---

## Известные ограничения

1. **Shadow DOM отсутствует** — полагаемся на CSS селекторы для инкапсуляции
2. **Нет SSR** — компоненты работают только в браузере
3. **Зависимость от BaseElement** — все компоненты должны наследоваться от него
4. **Стили загружаются глобально** — нет изоляции стилей между компонентами

---

## Планы на будущее (гипотетические)

### v2.0 (гипотетический)
- Поддержка Shadow DOM (опционально)
- TypeScript типизация
- SSR поддержка
- Поддержка React/Vue обёрток

---

*Последнее обновление: 2024*  
*Архитектура: State Sharing by Reference v2.0*
