# Беклог: Реализация микроразметки для SEO

## Этап 1: Базовая инфраструктура

### Задача 1.1: Создать структуру файлов
- [ ] Создать директорию `core/seo/`
- [ ] Создать `core/seo/seo-loader.php` - инициализация модуля
- [ ] Создать `core/seo/seo-meta-generator.php` - основной класс для генерации мета-тегов
- [ ] Подключить loader в `functions.php`

**Оценка**: 30 минут

### Задача 1.2: Создать базовый класс SEO_Meta_Generator
- [ ] Создать класс с методами:
  - `get_og_image($post_id)` - получение изображения с fallback
  - `get_og_description($post_id)` - получение описания
  - `get_toy_type_price_range($post_id)` - получение диапазона цен
  - `render_open_graph($post_id, $type)` - генерация OG тегов
  - `render_twitter_cards($post_id)` - генерация Twitter Cards
  - `render_schema_json_ld($post_id, $type)` - генерация Schema.org JSON-LD
- [ ] Добавить хук `wp_head` для вывода мета-тегов

**Оценка**: 1 час

## Этап 2: Страница типа игрушки (Приоритет 1)

### Задача 2.1: Open Graph для типа игрушки
- [ ] Реализовать `render_toy_type_open_graph($post_id)`
- [ ] Добавить все необходимые OG теги:
  - `og:type` = "product"
  - `og:title`, `og:description`, `og:image`, `og:url`
  - `product:price:amount`, `product:price:currency`
  - `product:availability`
- [ ] Интегрировать в `wp_head` с проверкой `is_singular('toy_type')`

**Оценка**: 1 час

### Задача 2.2: Twitter Cards для типа игрушки
- [ ] Реализовать `render_toy_type_twitter_cards($post_id)`
- [ ] Добавить теги: `twitter:card`, `twitter:title`, `twitter:description`, `twitter:image`
- [ ] Интегрировать в `wp_head`

**Оценка**: 30 минут

### Задача 2.3: Schema.org JSON-LD для типа игрушки
- [ ] Реализовать `render_toy_type_schema($post_id)`
- [ ] Создать JSON-LD структуру типа `Product`:
  - `name`, `description`, `image`
  - `offers` с типом `AggregateOffer` (диапазон цен)
  - `brand`, `category`
- [ ] Интегрировать в `wp_head`

**Оценка**: 1.5 часа

### Задача 2.4: Получение диапазона цен для типа игрушки
- [ ] Реализовать `get_toy_type_price_range($post_id)`
- [ ] Получить все связанные экземпляры через `connection_type_of_toy`
- [ ] Вычислить минимальную и максимальную цену из доступных экземпляров
- [ ] Учесть статусы экземпляров (только `publish`)

**Оценка**: 1 час

## Этап 3: Посты блога (Приоритет 2)

### Задача 3.1: Open Graph для постов
- [ ] Реализовать `render_post_open_graph($post_id)`
- [ ] Добавить OG теги типа `article`:
  - `og:type` = "article"
  - `og:title`, `og:description`, `og:image`, `og:url`
  - `article:published_time`, `article:modified_time`
  - `article:author` (если есть)
- [ ] Интегрировать с проверкой `is_single() && get_post_type() === 'post'`

**Оценка**: 45 минут

### Задача 3.2: Twitter Cards для постов
- [ ] Реализовать `render_post_twitter_cards($post_id)`
- [ ] Добавить стандартные Twitter Cards теги
- [ ] Интегрировать в `wp_head`

**Оценка**: 30 минут

### Задача 3.3: Schema.org для постов
- [ ] Реализовать `render_post_schema($post_id)`
- [ ] Создать JSON-LD структуру типа `Article` или `BlogPosting`:
  - `headline`, `description`, `image`
  - `datePublished`, `dateModified`
  - `author` (Person), `publisher` (Organization)
- [ ] Интегрировать в `wp_head`

**Оценка**: 1 час

## Этап 4: Обычные страницы (Приоритет 3)

### Задача 4.1: Open Graph для страниц
- [ ] Реализовать `render_page_open_graph($post_id)`
- [ ] Добавить OG теги типа `website`
- [ ] Интегрировать с проверкой `is_page() && !is_front_page()`

**Оценка**: 30 минут

### Задача 4.2: Twitter Cards для страниц
- [ ] Реализовать `render_page_twitter_cards($post_id)`
- [ ] Добавить стандартные Twitter Cards теги
- [ ] Интегрировать в `wp_head`

**Оценка**: 30 минут

### Задача 4.3: Schema.org для страниц
- [ ] Реализовать `render_page_schema($post_id)`
- [ ] Создать JSON-LD структуру типа `WebPage`
- [ ] Интегрировать в `wp_head`

**Оценка**: 30 минут

## Этап 5: Каталог (Приоритет 4)

### Задача 5.1: Open Graph для каталога
- [ ] Реализовать `render_catalog_open_graph()`
- [ ] Добавить OG теги для страницы каталога
- [ ] Интегрировать с проверкой `is_page_template('page-catalog.php')`

**Оценка**: 30 минут

### Задача 5.2: Twitter Cards для каталога
- [ ] Реализовать `render_catalog_twitter_cards()`
- [ ] Добавить стандартные Twitter Cards теги
- [ ] Интегрировать в `wp_head`

**Оценка**: 30 минут

### Задача 5.3: Schema.org для каталога
- [ ] Реализовать `render_catalog_schema()`
- [ ] Создать JSON-LD структуру типа `CollectionPage` или `WebPage`
- [ ] Интегрировать в `wp_head`

**Оценка**: 30 минут

## Этап 6: Главная страница (Приоритет 5)

### Задача 6.1: Open Graph для главной
- [ ] Реализовать `render_front_page_open_graph()`
- [ ] Добавить OG теги типа `website`
- [ ] Использовать название и описание сайта
- [ ] Интегрировать с проверкой `is_front_page()`

**Оценка**: 30 минут

### Задача 6.2: Twitter Cards для главной
- [ ] Реализовать `render_front_page_twitter_cards()`
- [ ] Добавить стандартные Twitter Cards теги
- [ ] Интегрировать в `wp_head`

**Оценка**: 30 минут

### Задача 6.3: Schema.org для главной
- [ ] Реализовать `render_front_page_schema()`
- [ ] Создать JSON-LD структуру типа `WebSite`
- [ ] Добавить `potentialAction` для поиска (если есть)
- [ ] Интегрировать в `wp_head`

**Оценка**: 45 минут

## Этап 7: Тестирование и оптимизация

### Задача 7.1: Тестирование всех страниц
- [ ] Протестировать Open Graph через Facebook Debugger
- [ ] Протестировать Twitter Cards через Twitter Card Validator
- [ ] Протестировать Schema.org через Schema.org Validator
- [ ] Протестировать Google Rich Results Test

**Оценка**: 2 часа

### Задача 7.2: Оптимизация изображений
- [ ] Убедиться, что все изображения имеют правильные размеры (1200x630 для OG)
- [ ] Добавить fallback для случаев отсутствия изображений
- [ ] Оптимизировать загрузку изображений

**Оценка**: 1 час

### Задача 7.3: Документация
- [ ] Обновить документацию с примерами использования
- [ ] Добавить комментарии в код
- [ ] Создать README для модуля SEO

**Оценка**: 30 минут

## Общая оценка времени

### Оценка для AI агента (текущая)
- **Этап 1**: 1.5 часа
- **Этап 2**: 4 часа
- **Этап 3**: 2.25 часа
- **Этап 4**: 1.5 часа
- **Этап 5**: 1.5 часа
- **Этап 6**: 1.75 часа
- **Этап 7**: 3.5 часа
- **Итого**: ~16 часов

### Реалистичная оценка для разработчика (человека)

**Факторы, которые увеличивают время:**
- Поиск и изучение документации по Open Graph, Twitter Cards, Schema.org
- Тестирование и отладка (проверка валидаторами, исправление ошибок)
- Понимание структуры данных WordPress (meta fields, taxonomies, relationships)
- Рефакторинг и оптимизация кода
- Непредвиденные проблемы (например, конфликты с плагинами, особенности WordPress)

**Реалистичные оценки:**
- **Этап 1**: 2-3 часа (создание структуры, изучение паттернов проекта)
- **Этап 2**: 5-6 часов (самый сложный, нужно разобраться с ценами, связями экземпляров)
- **Этап 3**: 2-3 часа (стандартная реализация для постов)
- **Этап 4**: 1.5-2 часа (простая реализация)
- **Этап 5**: 1.5-2 часа (простая реализация)
- **Этап 6**: 2-2.5 часа (нужно учесть особенности главной страницы)
- **Этап 7**: 4-6 часов (тестирование, отладка, исправление ошибок валидаторов)

**Итого для разработчика**: ~18-24 часа (2-3 рабочих дня)

**С учетом непредвиденных проблем и рефакторинга**: ~24-30 часов (3-4 рабочих дня)

## Порядок выполнения

1. Этап 1 (базовая инфраструктура)
2. Этап 2 (страница типа игрушки - самый важный)
3. Этап 3 (посты блога)
4. Этап 4 (обычные страницы)
5. Этап 5 (каталог)
6. Этап 6 (главная)
7. Этап 7 (тестирование)

---

## ⏱️ Тайминг реализации (AI агент)

**Начало реализации**: 2024-12-19 (основная реализация уже выполнена)
**Начало финализации и тестирования**: 2024-12-19 14:30:00 UTC
**Окончание реализации**: 2024-12-19 14:45:00 UTC

**Затраченное время на финализацию**: ~15 минут
- Проверка кода на ошибки
- Исправление формата диапазона цен в Open Graph (убрал дублирование product:price:amount)
- Удаление TODO комментариев
- Проверка линтером

**Общее время реализации (включая основную реализацию)**: ~1.5-2 часа
- Создание документации и беклога: ~20 минут
- Базовая инфраструктура: ~15 минут
- Реализация всех методов для всех типов страниц: ~45 минут
- Финализация и исправления: ~15 минут

**Сравнение с оценками:**
- Оценка в беклоге для AI: ~16 часов
- Реальное время AI: ~1.5-2 часа
- Реалистичная оценка для разработчика: ~24-30 часов

**Вывод**: AI агент работает значительно быстрее в задачах написания кода и чтения документации, но реальный разработчик потратил бы больше времени на изучение, тестирование и отладку.

